
\chapter{Results}

\section{Robustness}
\subsection{Perturbations effects}
The following graphs illustrates the impact of perturbations on segmentation performance. 
The columns correspond to the baseline and the six different perturbations (\ref{list:perturbations}). The rows depict the delta values of 
various segmentation metrics (\ref{list:metrics}), indicating the extent of variation in segmentation performance due to the perturbations. 
The baseline, having no delta, represents the original values for each metric. Each of the three boxplots corresponds to 
one of three levels of perturbation severity, providing a visual representation of how segmentation performance is affected 
at increasing degrees of perturbation. 
\vskip1em
The graph below represents the scenario in which perturbations are applied to nodal tumor labels in the CT modality.
\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{images/CT_Nodal.png}
    \caption{Perturbations applied to nodal tumor labels in the CT modality}
    \label{fig:three_subfigures}
\end{figure}
\newpage
\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{images/CT_Primary.png}
    \caption{Perturbations applied to primary tumor labels in the CT modality}
    \label{fig:three_subfigures}
\end{figure}

The graph illustrates significant variations in the Dice coefficient under spike, bias, and noise perturbations, 
underscoring their substantial impact on segmentation performance across both labels. Notably, the Hausdorff 
distance demonstrates that bias perturbation exerts the most pronounced negative effect, with the boxplot range extending 
up to 200. Sensitivity, specificity, and accuracy metrics exhibit trends consistent with the Dice coefficient, revealing 
markedly larger effects under spike, bias, and noise perturbations. In contrast, the model demonstrates relative robustness 
against motion, blur, and ghost perturbations, as indicated by minimal performance variability across all metrics.

Moreover, noise perturbation exhibits a less pronounced effect at the initial degree of severity compared to higher levels, 
while spike and bias perturbations show significant impact even at the first degree. 

Interestingly, in certain cases, the Dice coefficient delta is negative, indicating an improvement in segmentation 
performance under perturbation.This behavior suggests that certain perturbations may occasionally enhance segmentation accuracy, 
depending on the model and context.
\newpage
\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{images/PET_Nodal.png}
    \caption{Perturbations applied to primary tumor labels in the PET modality}
    \label{fig:three_subfigures}
\end{figure}
\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{images/PET_Primary.png}
    \caption{Perturbations applied to primary tumor labels in the PET modality}
    \label{fig:three_subfigures}
\end{figure}
The two graphs demonstrate the effect of perturbations on PET images across both labels. 
Similar to the behavior observed in CT images, spike, bias, and noise perturbations have a pronounced impact, 
while blur, ghost, and motion perturbations exhibit a more robust and stable performance. However, 
in the case of PET images, the first degree of noise and spike perturbations shows less variation in the Dice coefficient, 
sensitivity, specificity, and accuracy, indicating greater robustness compared to CT images. In contrast, 
bias perturbation continues to exert a substantial effect even at the first degree of severity, particularly 
in the Hausdorff distance, where a significant impact is still observed.

\subsection{Correlation with properties}
The following graphs present the correlation between the 13 previously discussed properties of the segmentation area (ref{}). Similar to the earlier graph, the figures are organized into 7 columns, with the baseline in the first column and the 6 perturbations in the subsequent columns. The baseline scatter plot illustrates the correlation between the original Dice coefficient and the segmentation properties, establishing a reference for the unperturbed performance. The columns corresponding to each perturbation display the correlation between the delta Dice (change in Dice coefficient) and the segmentation properties, highlighting whether significant segmentation degradation is associated with specific properties.

Each scatter plot includes data for all three degrees of perturbation, represented by distinct markers, allowing for visual differentiation of the effects of increasing perturbation severity. Also, the pearson correlation coefficient is visible for each degree.
The graphs presented here represent cases where perturbations have been applied to the nodal label in the CT modality. 
The remaining three category (Primary in CT, Nodal and Primary in PET) will be provided in the appendix. A more comprehensive correlation graph, encompassing all 
four categories, will follow to offer a broader view of the relationships between the segmentation properties and the applied perturbations.
\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{images/CT_Nodal_Properties_1.png}
    \caption{Correlation with perturbations applied to nodal tumor labels in the CT modality}
    \label{fig:three_subfigures}
\end{figure}

On the left, the Dice coefficient exhibits a crescent-shaped distribution rather than a clear linear correlation for the three properties related to tumor size and shape. The correlation is consistently higher for perturbations that exert a greater impact, as anticipated. In contrast, blur, motion, and ghost perturbations present a significantly flatter scatter plot with considerably smaller variations, reflecting the robustness observed in earlier analyses.

Among the perturbations, spike and noise demonstrate the strongest correlation with volume and surface area, with correlation coefficients ranging from 0.30 to 0.42, the highest being associated with surface area. In the case of bias, the correlation coefficient increases across the degrees of perturbation, showing a very low correlation at the first degree. By the third degree, the correlation reaches levels comparable to those of other perturbations. Notably, bias exhibits the highest correlation with compactness, although this correlation is not statistically significant, peaking at 0.21.

Interestingly, ghost perturbation reveals a prominent negative correlation, suggesting an improvement in segmentation performance, with the strongest correlation observed with the compactness property.
\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{images/CT_Nodal_Properties_2.png}
    \caption{Perturbations applied to primary tumor labels in the CT modality}
    \label{fig:three_subfigures}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{images/CT_Nodal_Properties_3.png}
    \caption{Perturbations applied to primary tumor labels in the CT modality}
    \label{fig:three_subfigures}
\end{figure}

The distance from the center did not demonstrate a significant correlation with any perturbation, with the highest coefficient reaching only 0.17. In contrast, for the boundary length, spike and noise perturbations exhibited correlation coefficients ranging from 0.20 to 0.30, while bias showed a correlation of 0.34 at the third degree of perturbation.

Regarding intensity properties, in CT variations, the only perturbation that displayed a significant correlation was noise, with coefficients of 0.38 and 0.31, but only at the first two degrees of severity. For PET variations, the correlation with noise was lower; however, spike demonstrated a stronger correlation, achieving a score of up to 0.41.

In terms of contrast, PET generally exhibited greater correlation, particularly with spike, which reached a maximum of 0.61. The third degree of noise showed a correlation of 0.38, while bias presented a more moderate correlation, peaking at 0.29.
\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{images/CT_Nodal_Properties_4.png}
    \caption{Perturbations applied to primary tumor labels in the CT modality}
    \label{fig:three_subfigures}
\end{figure}

For the last four properties analyzed, the SUVmax demonstrated a moderate correlation with spike perturbations, ranging from 0.29 to 0.43 across the degrees of severity. Noise and bias also exhibited correlations, albeit at more moderate levels, around 0.20. In the case of CT number, spike perturbations again displayed the strongest correlation, peaking at 0.32, while a surprising correlation of 0.28 was observed with ghost perturbations at the third degree. Notably, noise exhibited irregular behavior, with correlation coefficients fluctuating between -0.40 and 0.20.

The regions showed inconsistent behavior across properties, except for spike, which revealed a stable negative correlation ranging from -0.16 to -0.26. As expected, entropy demonstrated stronger correlations with effective perturbations, particularly spike, which reached values of up to 0.39, and bias at the third degree, which peaked at 0.42. Noise showed a more consistent behavior across degrees, with correlation coefficients ranging from 0.30 to 0.36.

Overall, among the 13 properties examined, the strongest correlations were observed with perturbations that most significantly affected segmentation performance. In contrast, blur, motion, and ghost perturbations exhibited only minor correlations due to their limited variability. For spike, bias, and noise, the correlation coefficients generally clustered around 0.30 to 0.40, with occasional peaks reaching up to 0.60.

In the following section, a more comprehensive correlation graphic will present the Pearson correlation coefficients of the various properties across each perturbation and degree, as well as for the four categories of images. This analysis will encompass both labels and modalities, providing a detailed overview of the relationships between segmentation properties and the applied perturbations.
\newpage
In those graphics, the y axis represent the perturbations with each time the 3 degrees of severity and on x axis the 13 properties analysed.
The correlation color scale is represented on the right.
\begin{figure}[ht]
    \centering
    \subfloat[Nodal tumors - CT]{\includegraphics[width=0.45\textwidth]{images/CT_Nodal_cor.PNG}}\hfill
    \subfloat[Primary tumors - CT]{\includegraphics[width=0.45\textwidth]{images/CT_Primary_cor.PNG}}\hfill
    \vfill
    \subfloat[Nodal tumors - PET]{\includegraphics[width=0.45\textwidth]{images/PET_Nodal_cor.PNG}}\hfill
    \subfloat[Primary tumors - PET]{\includegraphics[width=0.45\textwidth]{images/PET_Primary_cor.PNG}}\hfill
    \caption{Correlation graph for CT and PET modalities}
    \label{fig:four_subfigures}
\end{figure}
\newpage
Starting with the nodal label in the CT modality, we observe the same general trends identified in the previous section. The highest correlations are consistently seen with spike, bias, and noise perturbations, with most properties showing strong correlations with these perturbations. Notable exceptions include compactness, distance from center, CT variations, CT contrast, and regions, which do not exhibit significant correlations.

Spike emerges as the perturbation with the highest correlation scores, followed by noise and then bias. In contrast, ghost perturbations generally show an improvement in segmentation performance across most properties, with the strongest negative correlation observed for compactness. The only exception is CT contrast, which displays a positive correlation with ghost perturbations.

Blur and motion perturbations exhibit similar behavior, showing low correlation coefficients, consistent with previous analyses. Properties such as volume, surface area, boundary length, PET variations, SUVmax, and entropy display comparable responses to the perturbations. These properties generally show moderate positive correlations with spike, bias, and noise, while ghost perturbations produce negative correlations. Motion and blur have a minimal effect, with low correlation coefficients.

Interestingly, an increase in the number of regions appears to improve segmentation performance across all perturbations.

\newpage
\section{Clinical evaluation}


